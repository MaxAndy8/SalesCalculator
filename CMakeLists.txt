cmake_minimum_required(VERSION 3.21)

project(SalesCalculator
    VERSION 0.1.0
    LANGUAGES CXX
)

# ================================
# Global CMake settings
# ================================
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

# –£—Å—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –±—É–¥—É—é—Ç—å—Å—è —è–∫ position-independent (–≤–∞–∂–ª–∏–≤–æ –¥–ª—è shared libs)
set(CMAKE_POSITION_INDEPENDENT_CODE ON)

include(GNUInstallDirs)

# ================================
# Global options
# ================================
option(SC_ENABLE_TESTS "Enable tests" OFF)

# ================================
# Qt
# ================================
set(QT_MIN_VERSION 6.5)

# –û—Å–Ω–æ–≤–Ω—ñ Qt –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
find_package(Qt6 ${QT_MIN_VERSION} REQUIRED COMPONENTS
    Core
    Widgets
    Sql
    LinguistTools
)

# ================================
# Qt Auto Features
# ================================
set(CMAKE_AUTOMOC ON)    # MOC (signals/slots)
set(CMAKE_AUTOUIC ON)    # –û–±—Ä–æ–±–∫–∞ .ui —Ñ–∞–π–ª—ñ–≤
set(CMAKE_AUTORCC ON)    # –û–±—Ä–æ–±–∫–∞ .qrc —Ä–µ—Å—É—Ä—Å—ñ–≤

# ================================
# Project structure (Clean Architecture)
# ================================

# ==============================
# üîµ Domain layer (Enterprise Business Rules)
# - –ß–∏—Å—Ç–∞ –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
# - –ù–µ –∑–∞–ª–µ–∂–∏—Ç—å –Ω—ñ –≤—ñ–¥ —á–æ–≥–æ
# ==============================
add_subdirectory(src/domain)

# ==============================
# üü¢ Application layer (Use Cases)
# - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏
# - –ó–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ domain
# ==============================
add_subdirectory(src/application)

# ==============================
# üü† Infrastructure layer (Frameworks & Drivers)
# - –ë–î, —Ñ–∞–π–ª–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏, –º–µ—Ä–µ–∂–∞
# - –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤
# - –ó–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ domain
# ==============================
add_subdirectory(src/infrastructure)

# ==============================
# üü£ Core / Shared kernel
# - –ó–∞–≥–∞–ª—å–Ω—ñ —É—Ç–∏–ª—ñ—Ç–∏
# - Logger, AppContext, helpers
# - –ú–æ–∂–µ –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ domain
# ==============================
add_subdirectory(src/core)

# ==============================
# üü° UI Resources (Presentation support)
# - Qt .qrc
# - –Ü–∫–æ–Ω–∫–∏, —Å—Ç–∏–ª—ñ, –∫–∞—Ä—Ç–∏–Ω–∫–∏
# - –ù–∞–ª–µ–∂–∏—Ç—å –¥–æ Presentation layer
# ==============================
add_subdirectory(src/ui_resources)

# ==============================
# üü° UI i18n (Presentation support)
# - .ts / .qm –ø–µ—Ä–µ–∫–ª–∞–¥–∏
# - –ù–∞–ª–µ–∂–∏—Ç—å –¥–æ Presentation layer
# ==============================
add_subdirectory(src/ui_i18n)

# ==============================
# üî∑ UI layer (Presentation)
# - –í—ñ–∫–Ω–∞, –¥—ñ–∞–ª–æ–≥–∏, –≤—ñ–¥–∂–µ—Ç–∏
# - –ó–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ application + core
# ==============================
add_subdirectory(src/ui)

# ==============================
# üî¥ Composition Root / App layer
# - main()
# - –ó–±–∏—Ä–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
# - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è runtime
# ==============================
add_subdirectory(src/app)

# ================================
# Tests (optional)
# ================================
if (SC_ENABLE_TESTS)
    enable_testing()
    add_subdirectory(tests)
endif()
